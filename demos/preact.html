<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preact island demo</title>
    <script type="module">
        import "../mini-island.js"
    </script>
</head>
<body>
    <h1>Preact</h1>
    <p>This is a preact counter</p>
    <p>By default, this button is not rendered or hydrated</p>

    <mini-island client:idle>
        <div id="preact-app">
            <mark>
               the counter island will be rendered and hydrated only when browser is idle 
            </mark>

            <template data-island>
                <script type="module">
                    import {h, Component, render} from "https://esm.sh/preact";
                    import {useState} from "https://esm.sh/preact/hooks";
                    import htm from "https://esm.sh/htm"

                    // initialize htm with preact
                    const html = htm.bind(h)

                    function App(props) {
                        const [count, setCount] = useState(0);
                        const increment = () => 
                            setCount((currentCount) => currentCount + 1);

                            return html `<div>
                                    <button onClick=${() => increment()}>
                                        <span>up</span>
                                        <div>
                                            <strong>Preact</strong>
                                            <div>
                                                <span>${count}</span>
                                                <span>-</span>
                                                <span>clicks</span>
                                            </div>
                                        </div>
                                    </button>
                                </div>`
                    }

                    render(html`<${App} />`, document.getElementById("preact-app"));
                </script>
            </template>
        </div>
    </mini-island>

    <img src="https://i.imgur.com/Giic6YL.jpeg"/>
</body>
</html>